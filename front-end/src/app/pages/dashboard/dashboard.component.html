<div class="container-fluid mt-3">

  <!-- üîπ Filtros -->
  <mat-card class="mb-4 shadow-sm">
    <mat-card-header>
      <mat-card-title>
        <mat-icon color="primary" class="me-2">filter_alt</mat-icon>
        Filtros
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="filterForm" (ngSubmit)="applyFilters()" class="row g-3">

        <!-- Data (range) -->
        <div class="col-md-2">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Per√≠odo</mat-label>
            <mat-date-range-input [formGroup]="filterForm" [rangePicker]="picker">
              <input matStartDate formControlName="startDate" placeholder="In√≠cio">
              <input matEndDate formControlName="endDate" placeholder="Fim">
            </mat-date-range-input>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker></mat-date-range-picker>
          </mat-form-field>
        </div>

        <!-- Categoria -->
        <div class="col-md-2">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Categoria</mat-label>
            <mat-select formControlName="categoryId">
              <mat-option *ngFor="let category of categories" [value]="category.id">
                {{ category.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Fornecedor -->
        <div class="col-md-3">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Fornecedor</mat-label>
            <mat-select formControlName="supplierId">
              <mat-option *ngFor="let supplier of suppliers" [value]="supplier.id">
                {{ supplier.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Pagador -->
        <div class="col-md-3">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Pagador</mat-label>
            <mat-select formControlName="payerId">
              <mat-option *ngFor="let payer of payers" [value]="payer.id">
                {{ payer.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Filtro Contrato -->
        <div class="col-md-2">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Contrato de Servi√ßo</mat-label>
            <mat-select formControlName="serviceContractId">
              <mat-option [value]="null">Todos</mat-option>
              <mat-option *ngFor="let contract of serviceContracts" [value]="contract.id">
                {{ contract.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="row justify-content-end">

          <!-- Bot√£o aplicar -->
          <div class="col-md-2 d-flex align-items-center">
            <button mat-raised-button color="primary" type="submit" class="w-100">
              <mat-icon class="me-1">search</mat-icon>
              Aplicar
            </button>
          </div>

          <!-- Bot√£o limpar -->
          <div class="col-md-2 d-flex align-items-center">
            <button mat-raised-button color="warn" type="button" class="w-100" (click)="onClear()">
              <mat-icon class="me-1">clear</mat-icon>
              Limpar
            </button>
          </div>

        </div>



      </form>
    </mat-card-content>
  </mat-card>

  <!-- üîπ KPIs -->
  <div class="row">
    <div class="col-lg-3 col-md-6 col-sm-6" *ngFor="let kpi of kpis">
      <div class="card card-stats">
        <div class="card-body">
          <div class="row">
            <div class="col-5 col-md-4">
              <div class="icon-big text-center" [ngClass]="kpi.iconColor">
                <i class="{{ kpi.icon }}"></i>
              </div>
            </div>
            <div class="col-7 col-md-8">
              <div class="numbers">
                <p class="card-category">{{ kpi.label }}</p>
                <p class="card-title">{{ kpi.value }}</p>
              </div>
            </div>
          </div>
        </div>
        <div class="card-footer">
          <hr>
          <div class="stats">
            <i class="fa fa-refresh"></i> {{ kpi.footer }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- üîπ Gr√°ficos -->
  <div class="row mt-4">
    <!-- Categoria -->
    <div class="col-md-4">
      <div class="card card-chart">
        <div class="card-header">
          <h5 class="card-title">Despesas por Categoria</h5>
          <p class="card-category">Distribui√ß√£o por categorias</p>
        </div>
        <div class="card-body">
          <canvas id="chartCategory"></canvas>
        </div>
      </div>
    </div>

    <!-- M√©todo de Pagamento -->
    <div class="col-md-4">
      <div class="card card-chart">
        <div class="card-header">
          <h5 class="card-title">Despesas por M√©todo de Pagamento</h5>
          <p class="card-category">Formas de pagamento utilizadas</p>
        </div>
        <div class="card-body">
          <canvas id="chartPaymentMethod"></canvas>
        </div>
      </div>
    </div>

    <!-- M√™s -->
    <div class="col-md-4">
      <div class="card card-chart">
        <div class="card-header">
          <h5 class="card-title">Despesas por M√™s</h5>
          <p class="card-category">Evolu√ß√£o mensal</p>
        </div>
        <div class="card-body">
          <canvas id="chartMonth"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <!-- Fornecedor -->
    <div class="col-md-6">
      <div class="card card-chart">
        <div class="card-header">
          <h5 class="card-title">Despesas por Fornecedor</h5>
          <p class="card-category">Top fornecedores</p>
        </div>
        <div class="card-body">
          <canvas id="chartSupplier"></canvas>
        </div>
      </div>
    </div>

    <!-- Pagador -->
    <div class="col-md-6">
      <div class="card card-chart">
        <div class="card-header">
          <h5 class="card-title">Despesas por Pagador</h5>
          <p class="card-category">Quem realizou os pagamentos</p>
        </div>
        <div class="card-body">
          <canvas id="chartPayer"></canvas>
        </div>
      </div>
    </div>
  </div>

</div>